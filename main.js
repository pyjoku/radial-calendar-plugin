/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

"use strict";var q=Object.defineProperty;var me=Object.getOwnPropertyDescriptor;var fe=Object.getOwnPropertyNames;var De=Object.prototype.hasOwnProperty;var be=(l,e)=>{for(var t in e)q(l,t,{get:e[t],enumerable:!0})},Se=(l,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let a of fe(e))!De.call(l,a)&&a!==t&&q(l,a,{get:()=>e[a],enumerable:!(n=me(e,a))||n.enumerable});return l};var Ee=l=>Se(q({},"__esModule",{value:!0}),l);var Pe={};be(Pe,{default:()=>U});module.exports=Ee(Pe);var J=require("obsidian");var O=class{constructor(e){this.app=e}getAllMarkdownFiles(){return this.app.vault.getMarkdownFiles().map(t=>this.toFileInfo(t))}getMarkdownFilesInFolder(e){return this.getAllMarkdownFiles().filter(t=>t.folderPath?t.folderPath===e||t.folderPath.startsWith(e+"/"):!1)}getFileByPath(e){let t=this.app.vault.getAbstractFileByPath(e);return t instanceof this.getTFileClass()?t:null}async readFile(e){let t=this.getFileByPath(e);if(!t)return null;try{return await this.app.vault.read(t)}catch(n){return null}}async createOrOpenDailyNote(e,t=""){let n=this.getFileByPath(e);if(!n){let a=e.substring(0,e.lastIndexOf("/"));a&&await this.ensureFolderExists(a),n=await this.app.vault.create(e,t)}return n}async ensureFolderExists(e){this.app.vault.getAbstractFileByPath(e)||await this.app.vault.createFolder(e)}fileExists(e){return this.getFileByPath(e)!==null}getRoot(){return this.app.vault.getRoot()}toFileInfo(e){var t,n;return Object.freeze({path:e.path,basename:e.basename,name:e.name,extension:e.extension,folderPath:(n=(t=e.parent)==null?void 0:t.path)!=null?n:null})}getTFileClass(){let e=this.app.vault.getMarkdownFiles();return e.length>0?e[0].constructor:class{}}};var k=class{constructor(e){this.app=e}getMetadata(e){let t=this.app.metadataCache.getFileCache(e);return this.extractMetadata(t)}getMetadataByPath(e){let t=this.app.vault.getAbstractFileByPath(e);return!t||!this.isMarkdownFile(t)?null:this.getMetadata(t)}getProperty(e,t){var a;return(a=this.getMetadata(e).frontmatter)==null?void 0:a[t]}getStringProperty(e,t){let n=this.getProperty(e,t);return typeof n=="string"?n:n instanceof Date?this.formatDate(n):typeof n=="number"?String(n):null}getDateProperty(e,t){let n=this.getProperty(e,t);if(!n)return null;if(typeof n=="string"){if(/^\d{4}-\d{2}-\d{2}$/.test(n))return n;let a=n.match(/^(\d{4}-\d{2}-\d{2})/);return a?a[1]:null}return n instanceof Date&&!isNaN(n.getTime())?this.formatDate(n):this.isLocalDateLike(n)?this.formatLocalDate(n):null}getTags(e){return this.getMetadata(e).tags}hasTag(e,t){let n=t.startsWith("#")?t:`#${t}`;return this.getTags(e).some(i=>i.tag.toLowerCase()===n.toLowerCase())}onMetadataChange(e){let t=n=>e(n);return this.app.metadataCache.on("changed",t),()=>this.app.metadataCache.off("changed",t)}extractMetadata(e){var a;let t=(a=e==null?void 0:e.frontmatter)!=null?a:null,n=[];if(t!=null&&t.tags){let i=Array.isArray(t.tags)?t.tags:[t.tags];for(let r of i)if(typeof r=="string"){let s=r.startsWith("#")?r:`#${r}`;n.push({tag:s,name:s.substring(1)})}}if(e!=null&&e.tags)for(let i of e.tags)n.find(s=>s.tag.toLowerCase()===i.tag.toLowerCase())||n.push({tag:i.tag,name:i.tag.substring(1)});return Object.freeze({frontmatter:t,tags:Object.freeze(n)})}formatDate(e){let t=e.getFullYear(),n=String(e.getMonth()+1).padStart(2,"0"),a=String(e.getDate()).padStart(2,"0");return`${t}-${n}-${a}`}formatLocalDate(e){let t=e.year,n=String(e.month).padStart(2,"0"),a=String(e.day).padStart(2,"0");return`${t}-${n}-${a}`}isLocalDateLike(e){return typeof e=="object"&&e!==null&&"year"in e&&"month"in e&&"day"in e&&typeof e.year=="number"&&typeof e.month=="number"&&typeof e.day=="number"}isMarkdownFile(e){return typeof e=="object"&&e!==null&&"extension"in e&&e.extension==="md"}};function M(l,e,t){let n={year:l,month:e,day:t};if(!ee(n))throw new Error(`Invalid date: ${l}-${e}-${t}`);return Object.freeze(n)}function R(l){let e=l.month.toString().padStart(2,"0"),t=l.day.toString().padStart(2,"0");return`${l.year}-${e}-${t}`}function v(l,e){return l.year!==e.year?l.year-e.year:l.month!==e.month?l.month-e.month:l.day-e.day}function B(l,e){return l.year===e.year&&l.month===e.month&&l.day===e.day}function ee(l){let{year:e,month:t,day:n}=l;if(!Number.isInteger(e)||e<1||!Number.isInteger(t)||t<1||t>12||!Number.isInteger(n)||n<1)return!1;let a=C(e,t);return n<=a}function C(l,e){let t=[31,28,31,30,31,30,31,31,30,31,30,31];return e===2&&te(l)?29:t[e-1]}function te(l){return l%4===0&&l%100!==0||l%400===0}function x(l){let e=l.year,t=l.month,n=l.day;t<3&&(t+=12,e-=1);let a=n,i=t,r=e%100,s=Math.floor(e/100),o=(a+Math.floor(13*(i+1)/5)+r+Math.floor(r/4)+Math.floor(s/4)-2*s)%7;return o=(o%7+7)%7,(o+6)%7}function w(){let l=new Date;return Object.freeze({year:l.getFullYear(),month:l.getMonth()+1,day:l.getDate()})}var $=class{constructor(e={}){var t,n;this.entriesByPath=new Map,this.entriesByDate=new Map,this.multiDayEntriesByDate=new Map,this.stats={hits:0,misses:0,lastRebuild:0},this.config={maxEntries:(t=e.maxEntries)!=null?t:1e4,debug:(n=e.debug)!=null?n:!1}}addEntry(e){this.removeEntry(e.filePath),this.entriesByPath.set(e.filePath,e);let t=R(e.startDate);this.addToDateIndex(t,e,this.entriesByDate),e.isMultiDay&&e.endDate&&this.indexMultiDayEntry(e),this.log(`Added entry: ${e.filePath}`)}removeEntry(e){let t=this.entriesByPath.get(e);if(!t)return;this.entriesByPath.delete(e);let n=R(t.startDate);this.removeFromDateIndex(n,t.id,this.entriesByDate),t.isMultiDay&&t.endDate&&this.removeMultiDayEntry(t),this.log(`Removed entry: ${e}`)}getEntriesForDate(e){var r,s;let t=R(e),n=(r=this.entriesByDate.get(t))!=null?r:[],a=(s=this.multiDayEntriesByDate.get(t))!=null?s:[];n.length>0||a.length>0?this.stats.hits++:this.stats.misses++;let i=new Map;for(let o of n)i.set(o.id,o);for(let o of a)i.set(o.id,o);return Array.from(i.values())}getEntriesInRange(e,t){var a;let n=new Map;for(let i of this.entriesByPath.values()){let r=(a=i.endDate)!=null?a:i.startDate;v(i.startDate,t)<=0&&v(r,e)>=0&&n.set(i.id,i)}return Array.from(n.values())}getMultiDayEntries(){return Array.from(this.entriesByPath.values()).filter(e=>e.isMultiDay)}getEntryByPath(e){return this.entriesByPath.get(e)}hasEntry(e){return this.entriesByPath.has(e)}getAllEntries(){return Array.from(this.entriesByPath.values())}clear(){this.entriesByPath.clear(),this.entriesByDate.clear(),this.multiDayEntriesByDate.clear(),this.stats={hits:0,misses:0,lastRebuild:Date.now()},this.log("Cache cleared")}rebuild(e){this.clear(),this.stats.lastRebuild=Date.now();for(let t of e)this.addEntry(t);this.log(`Cache rebuilt with ${e.length} entries`)}getStats(){return Object.freeze({entryCount:this.entriesByPath.size,dateCount:this.entriesByDate.size+this.multiDayEntriesByDate.size,hits:this.stats.hits,misses:this.stats.misses,lastRebuild:this.stats.lastRebuild})}indexMultiDayEntry(e){if(!e.endDate)return;let t=e.startDate,n=e.endDate;for(;v(t,n)<0;)if(t=this.addOneDay(t),v(t,n)<=0){let a=R(t);this.addToDateIndex(a,e,this.multiDayEntriesByDate)}}removeMultiDayEntry(e){if(!e.endDate)return;let t=e.startDate,n=e.endDate;for(;v(t,n)<0;)if(t=this.addOneDay(t),v(t,n)<=0){let a=R(t);this.removeFromDateIndex(a,e.id,this.multiDayEntriesByDate)}}addToDateIndex(e,t,n){let a=n.get(e);a?a.push(t):n.set(e,[t])}removeFromDateIndex(e,t,n){let a=n.get(e);if(!a)return;let i=a.filter(r=>r.id!==t);i.length===0?n.delete(e):n.set(e,i)}addOneDay(e){let t=e.day+1,n=e.month,a=e.year,i=this.getDaysInMonth(a,n);return t>i&&(t=1,n+=1,n>12&&(n=1,a+=1)),{year:a,month:n,day:t}}getDaysInMonth(e,t){let n=[31,28,31,30,31,30,31,31,30,31,30,31];return t===2?e%4===0&&e%100!==0||e%400===0?29:28:n[t-1]}log(e){this.config.debug&&console.log(`[EntryCache] ${e}`)}};var V=class V{parseDate(e){if(e==null)return null;if(typeof e=="string")return this.parseDateString(e);if(e instanceof Date)return isNaN(e.getTime())?null:{year:e.getFullYear(),month:e.getMonth()+1,day:e.getDate()};if(typeof e=="object"&&e!==null){let t=e;if(typeof t.year=="number"&&typeof t.month=="number"&&typeof t.day=="number"&&this.isValidDate(t.year,t.month,t.day))return{year:t.year,month:t.month,day:t.day}}return null}parseDateString(e){let n=e.trim().match(/^(\d{4})-(\d{2})-(\d{2})$/);if(!n)return null;let a=parseInt(n[1],10),i=parseInt(n[2],10),r=parseInt(n[3],10);return this.isValidDate(a,i,r)?{year:a,month:i,day:r}:null}isValidDate(e,t,n){if(e<1900||e>2100||t<1||t>12||n<1||n>31)return!1;let a=this.getDaysInMonth(e,t);return!(n>a)}getDaysInMonth(e,t){let n=[31,28,31,30,31,30,31,31,30,31,30,31];return t===2&&this.isLeapYear(e)?29:n[t-1]}isLeapYear(e){return e%4===0&&e%100!==0||e%400===0}extractFromFilename(e){let t={start:null,end:null};if(!e||typeof e!="string")return t;let n=e.match(V.DATE_PATTERN);return!n||n.length===0||(t.start=this.parseDate(n[0]),n.length>=2&&(t.end=this.parseDate(n[1]))),t}extractFromProperties(e,t){if(!e||typeof e!="object"||!Array.isArray(t))return null;for(let n of t){if(typeof n!="string"||!n)continue;let a=e[n];if(a==null)continue;let i=this.parseDate(a);if(i!==null)return i}return null}extractDates(e,t,n){let a={start:null,end:null},i=this.extractFromFilename(e);for(let r of n.priorities)r==="filename"?(a.start===null&&i.start!==null&&(a.start=i.start),a.end===null&&i.end!==null&&(a.end=i.end)):r==="properties"&&(a.start===null&&(a.start=this.extractFromProperties(t,n.startSources)),a.end===null&&(a.end=this.extractFromProperties(t,n.endSources)));return a}};V.DATE_PATTERN=/(\d{4}-\d{2}-\d{2})/g;var F=V,Ye=new F;var ve=["January","February","March","April","May","June","July","August","September","October","November","December"],Y=class{getDaysInMonth(e,t){return C(e,t)}getFirstDayOfWeek(e,t){let n=M(e,t,1);return x(n)}isToday(e){let t=w();return B(e,t)}generateGrid(e){let t=[];for(let n=1;n<=12;n++)t.push(this.generateMonth(e,n));return{year:e,months:t}}generateMonth(e,t){let n=this.getDaysInMonth(e,t),a=this.getFirstDayOfWeek(e,t),i=[];for(let r=0;r<a;r++)i.push({date:M(e,t,1),isToday:!1,isEmpty:!0});for(let r=1;r<=n;r++){let s=M(e,t,r);i.push({date:s,isToday:this.isToday(s),isEmpty:!1})}return{month:t,name:ve[t-1],startDayOfWeek:a,daysInMonth:n,days:i}}};var Ce=24,P=class{calculateMonthSegments(e,t,n){let a=[];if(v(e,t)>0)return a;let i=e.year,r=e.month,s=0;for(;s<Ce;){let o=i===e.year&&r===e.month,c=i===t.year&&r===t.month,h=o?e.day:1,g=c?t.day:C(i,r);if(a.push({year:i,month:r,startDay:h,endDay:g,entryId:n}),c)break;r++,r>12&&(r=1,i++),s++}return a}calculateBarPositions(e,t){let n=new Map;if(e.length===0)return n;let a=[...e].sort((r,s)=>r.startDay!==s.startDay?r.startDay-s.startDay:s.endDay-s.startDay-(r.endDay-r.startDay)),i=[];for(let r=0;r<=31;r++)i.push(new Set);for(let r of a){let s=(t.startDayOfWeek+r.startDay-1)%7,o=(t.startDayOfWeek+r.endDay-1)%7,c=r.endDay-r.startDay+1,h=0,g=!1;for(;!g;){let u=!0;for(let d=r.startDay;d<=r.endDay;d++)if(i[d].has(h)){u=!1;break}if(u){g=!0;for(let d=r.startDay;d<=r.endDay;d++)i[d].add(h)}else h++;if(h>100)break}n.set(r.entryId,{rowIndex:h,startColumn:s,endColumn:o,span:c})}return n}},He=new P;function K(l){let e=l.endDate!==null&&(l.startDate.year!==l.endDate.year||l.startDate.month!==l.endDate.month||l.startDate.day!==l.endDate.day);return Object.freeze({id:l.id,filePath:l.filePath,fileName:l.fileName,displayName:l.displayName,startDate:l.startDate,endDate:l.endDate,isMultiDay:e,metadata:Object.freeze({tags:Object.freeze([...l.metadata.tags]),folder:l.metadata.folder,properties:Object.freeze({...l.metadata.properties})})})}var _=class{constructor(e,t){this.unregisterMetadataListener=null;this.eventListeners=null;this.vaultRepository=new O(e),this.metadataRepository=new k(e),this.entryCache=new $({debug:!1}),this.dateEngine=new F,this.calendarEngine=new Y,this.multiDayEngine=new P,this.settings=t,this.currentYear=w().year}async initialize(){await this.rebuildCache(),this.setupMetadataListener()}destroy(){this.unregisterMetadataListener&&(this.unregisterMetadataListener(),this.unregisterMetadataListener=null),this.eventListeners=null}setEventListeners(e){this.eventListeners=e}async updateSettings(e){let t=this.settings.dateProperties.join(",")!==e.dateProperties.join(",")||this.settings.endDateProperties.join(",")!==e.endDateProperties.join(",")||this.settings.datePriority!==e.datePriority;this.settings=e,t&&await this.rebuildCache()}getCurrentYear(){return this.currentYear}setCurrentYear(e){var t;this.currentYear!==e&&(this.currentYear=e,(t=this.eventListeners)==null||t.onYearChanged(e))}nextYear(){this.setCurrentYear(this.currentYear+1)}previousYear(){this.setCurrentYear(this.currentYear-1)}goToToday(){this.setCurrentYear(w().year)}generateCalendarGrid(){return this.calendarEngine.generateGrid(this.currentYear)}getEntriesForDate(e){return this.entryCache.getEntriesForDate(e)}getMultiDayEntries(){return this.entryCache.getMultiDayEntries().filter(e=>{var i;let t={year:this.currentYear,month:1,day:1},n={year:this.currentYear,month:12,day:31},a=(i=e.endDate)!=null?i:e.startDate;return e.startDate.year===this.currentYear||e.startDate.year<this.currentYear&&a.year>=this.currentYear})}calculateBarPositions(e,t){return new Map}async openDailyNote(e){let t=this.settings.dailyNoteFormat,n=this.settings.dailyNoteFolder,a=this.formatDailyNoteFilename(e,t),i=n?`${n}/${a}.md`:`${a}.md`,r=await this.vaultRepository.createOrOpenDailyNote(i);console.log(`Opening daily note: ${r.path}`)}getCacheStats(){let e=this.entryCache.getStats();return{entryCount:e.entryCount,dateCount:e.dateCount}}async rebuildCache(){var a;let e=this.vaultRepository.getAllMarkdownFiles(),t=[],n=this.getDateExtractionConfig();for(let i of e){let r=this.createEntryFromFile(i,n);r&&t.push(r)}this.entryCache.rebuild(t),(a=this.eventListeners)==null||a.onEntriesUpdated()}createEntryFromFile(e,t){var o,c,h;let n=this.metadataRepository.getMetadataByPath(e.path),a=(o=n==null?void 0:n.frontmatter)!=null?o:null,{start:i,end:r}=this.dateEngine.extractDates(e.name,a,t);if(!i)return null;let s={};if(a)for(let[g,u]of Object.entries(a))(typeof u=="string"||typeof u=="number"||typeof u=="boolean")&&(s[g]=u);return K({id:e.path,filePath:e.path,fileName:e.name,displayName:e.basename,startDate:i,endDate:r,metadata:{tags:(c=n==null?void 0:n.tags.map(g=>g.name))!=null?c:[],folder:(h=e.folderPath)!=null?h:"",properties:s}})}getDateExtractionConfig(){return{startSources:this.settings.dateProperties,endSources:this.settings.endDateProperties,priorities:this.settings.datePriority==="property"?["properties","filename"]:["filename","properties"]}}formatDailyNoteFilename(e,t){return t.replace("YYYY",String(e.year)).replace("MM",String(e.month).padStart(2,"0")).replace("DD",String(e.day).padStart(2,"0"))}setupMetadataListener(){this.unregisterMetadataListener=this.metadataRepository.onMetadataChange(e=>{this.handleFileChange(e.path)})}handleFileChange(e){var n;let t=this.vaultRepository.getAllMarkdownFiles().find(a=>a.path===e);if(!t)this.entryCache.removeEntry(e);else{let a=this.getDateExtractionConfig(),i=this.createEntryFromFile(t,a);i?this.entryCache.addEntry(i):this.entryCache.removeEntry(e)}(n=this.eventListeners)==null||n.onEntriesUpdated()}};var G=require("obsidian");var xe=Object.freeze({fromFilename:!0,fromFrontmatter:!0,frontmatterField:"date",endDateField:"endDate",filenamePatterns:Object.freeze(["^(\\d{4}-\\d{2}-\\d{2})","(\\d{4}-\\d{2}-\\d{2})$","^(\\d{4}-\\d{2}-\\d{2})[-_\\s]","[-_\\s](\\d{4}-\\d{2}-\\d{2})\\.md$"]),useCreationDateFallback:!1}),Te=Object.freeze({includeFolders:Object.freeze([]),excludeFolders:Object.freeze([])}),Re=Object.freeze({firstDayOfWeek:1,showWeekNumbers:!1,highlightToday:!0,showAdjacentMonths:!0,maxEntriesPerDay:3,showMultiDayBars:!0}),Ft=Object.freeze({dateExtraction:xe,folderFilter:Te,display:Re,locale:"en-US",debugMode:!1});var L={red:"#ef4444",orange:"#f97316",yellow:"#eab308",green:"#22c55e",blue:"#3b82f6",purple:"#a855f7",pink:"#ec4899",teal:"#14b8a6",cyan:"#06b6d4",magenta:"#d946ef",lime:"#84cc16",amber:"#f59e0b",indigo:"#6366f1",violet:"#8b5cf6",rose:"#f43f5e",gray:"#6b7280",slate:"#64748b",stone:"#78716c"};function ne(l){return{id:`ring-${Date.now()}-${Math.random().toString(36).substr(2,9)}`,name:`Ring ${l+1}`,folder:"",color:"blue",segmentType:"monthly",enabled:!0,order:l}}var ae=[{id:"spring",label:"Fr\xFChling",startDay:60,endDay:152},{id:"summer",label:"Sommer",startDay:152,endDay:244},{id:"autumn",label:"Herbst",startDay:244,endDay:335},{id:"winter",label:"Winter",startDay:335,endDay:60}],re=[{id:"q1",label:"Q1",startDay:1,endDay:90},{id:"q2",label:"Q2",startDay:91,endDay:181},{id:"q3",label:"Q3",startDay:182,endDay:273},{id:"q4",label:"Q4",startDay:274,endDay:365}],ie=[{id:"s1",label:"H1",startDay:1,endDay:181},{id:"s2",label:"H2",startDay:182,endDay:365}];function se(){let l=[],e=1,t=1;for(;e<=365;){let n=Math.min(e+9,365);l.push({id:`10d-${t}`,label:`P${t}`,startDay:e,endDay:n}),e=n+1,t++}return l}function oe(){let l=[];for(let e=1;e<=52;e++){let t=(e-1)*7+1,n=Math.min(e*7,365);l.push({id:`kw-${e}`,label:`KW${e}`,startDay:t,endDay:n})}return l}var X={currentView:"annual",birthYear:1990,expectedLifespan:85,currentYear:new Date().getFullYear(),rings:[],centerDisplay:"countdown",periodicNotesFormat:{yearly:"YYYY",monthly:"YYYY-MM",daily:"YYYY-MM-DD"},templateFolder:"Templates",annualSegmentType:"none",customSegments:[],lifeActs:[],showSegmentLabels:!0},le=`---
# === RADIAL CALENDAR TEMPLATE ===
# L\xF6sche die Zeilen, die du nicht brauchst

# FARBEN (w\xE4hle eine):
ring-color: blue
# ring-color: red
# ring-color: orange
# ring-color: yellow
# ring-color: green
# ring-color: teal
# ring-color: purple
# ring-color: magenta
# ring-color: pink
# ring-color: cyan
# ring-color: lime
# ring-color: amber
# ring-color: indigo

# STIL (w\xE4hle einen):
ring-style: solid
# ring-style: striped
# ring-style: dotted
# ring-style: gradient

# LABEL & ICON:
ring-label: ""
ring-icon: circle

# ZEITRAUM:
date: {{date}}
# end-date:

# FORTSCHRITT (0-100):
# ring-progress: 0
---

# {{title}}

`;var I="radial-calendar-plugin",Ae=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],Q=["January","February","March","April","May","June","July","August","September","October","November","December"],Z=800,m=Z/2,b=380,T=120,de=100,Yt=(b-T)/31,ce=4,Fe=20,ge=b+2,ue=b+8,he=b+14,z=class extends G.ItemView{constructor(t){super(t);this.config=null;this.containerEl_=null;this.svgEl=null;this.tooltipEl=null}getViewType(){return I}getDisplayText(){return"Radial Calendar"}getIcon(){return"circle"}initialize(t){this.config=t,this.config.service.setEventListeners({onEntriesUpdated:()=>this.render(),onYearChanged:()=>this.render()})}async onOpen(){this.containerEl_=this.contentEl,this.containerEl_.addClass("radial-calendar-plugin"),this.render()}async onClose(){var t;(t=this.containerEl_)==null||t.empty(),this.containerEl_=null,this.svgEl=null,this.tooltipEl=null}render(){if(!this.containerEl_||!this.config)return;this.containerEl_.empty();let n=this.config.service.getCurrentYear(),a=this.containerEl_.createDiv({cls:"rc-container"});this.renderHeader(a,n);let i=a.createDiv({cls:"rc-wrapper"});this.renderRadialCalendar(i,n),this.tooltipEl=a.createDiv({cls:"rc-tooltip"}),this.tooltipEl.style.display="none"}renderHeader(t,n){if(!this.config)return;let a=t.createDiv({cls:"rc-header"});a.createEl("button",{text:"\u2190",cls:"rc-nav-btn",attr:{"aria-label":"Previous year"}}).addEventListener("click",()=>{var o;(o=this.config)==null||o.service.previousYear()}),a.createEl("span",{text:String(n),cls:"rc-year-title"}),a.createEl("button",{text:"\u2192",cls:"rc-nav-btn",attr:{"aria-label":"Next year"}}).addEventListener("click",()=>{var o;(o=this.config)==null||o.service.nextYear()}),a.createEl("button",{text:"Today",cls:"rc-nav-btn rc-today-btn",attr:{"aria-label":"Go to today"}}).addEventListener("click",()=>{var o;(o=this.config)==null||o.service.goToToday()}),this.renderViewModeToggle(a)}renderViewModeToggle(t){if(!this.config)return;let n=this.config.settings.currentView,a=t.createDiv({cls:"rc-view-toggle"});a.createEl("button",{text:"Jahresansicht",cls:`rc-toggle-btn ${n==="annual"?"rc-toggle-btn--active":""}`,attr:{"aria-label":"Switch to annual view"}}).addEventListener("click",async()=>{if(this.config&&this.config.settings.currentView!=="annual"){let s={...this.config.settings,currentView:"annual"};await this.config.onSettingsChange(s),this.render()}}),a.createEl("button",{text:"Lebensansicht",cls:`rc-toggle-btn ${n==="life"?"rc-toggle-btn--active":""}`,attr:{"aria-label":"Switch to life view"}}).addEventListener("click",async()=>{if(this.config&&this.config.settings.currentView!=="life"){let s={...this.config.settings,currentView:"life"};await this.config.onSettingsChange(s),this.render()}})}renderRadialCalendar(t,n){if(!this.config)return;let a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.setAttribute("viewBox",`0 0 ${Z} ${Z}`),a.setAttribute("class","rc-svg"),this.svgEl=a,this.renderBackgroundCircle(a);let i=this.getEnabledRingsSorted();if(i.length===0)for(let r=1;r<=12;r++)this.renderMonthSegment(a,n,r);else{let r=this.calculateRingRadii(i.length);for(let s of i){let o=r.get(s.order);o&&this.renderRing(a,n,s,o)}}for(let r=1;r<=12;r++)this.renderMonthSeparator(a,this.monthToAngle(r));this.renderOuterSegments(a,n),this.renderCenter(a,n),this.renderMonthLabels(a),this.renderTodayMarker(a,n),t.appendChild(a)}getEnabledRingsSorted(){return this.config?this.config.settings.rings.filter(t=>t.enabled).sort((t,n)=>t.order-n.order):[]}calculateRingRadii(t){let n=new Map;if(t===0)return n;let a=(t-1)*ce,i=b-T-a,r=Math.max(Fe,i/t);for(let s=0;s<t;s++){let o=b-s*(r+ce),c=o-r;n.set(s,{outerRadius:o,innerRadius:c})}return n}renderRing(t,n,a,i){if(!this.config)return;let r=L[a.color]||L.blue;for(let s=1;s<=12;s++)this.renderRingMonthSegment(t,n,s,a,i,r)}renderRingMonthSegment(t,n,a,i,r,s){if(!this.config)return;let o=C(n,a),c=this.monthToAngle(a),g=Math.PI/6/o,u=w(),d=u.year===n&&u.month===a,y=this.config.service.getEntriesForDate(M(n,a,1));for(let f=1;f<=o;f++){let D=M(n,a,f),E=x(D),S=d&&u.day===f,A=E===0||E===6,N=c+(f-1)*g,ye=N+g-.002,pe=this.getEntriesForRing(D,i);this.renderRingDayArc(t,D,N,ye,S,A,pe,r,s,i)}}getEntriesForRing(t,n){if(!this.config)return[];let a=this.config.service.getEntriesForDate(t);if(!n.folder||n.folder.trim()==="")return a;let i=n.folder.replace(/^\/+|\/+$/g,"");return a.filter(r=>{let o=(r.metadata.folder||"").replace(/^\/+|\/+$/g,"");return o===i||o.startsWith(i+"/")})}renderRingDayArc(t,n,a,i,r,s,o,c,h,g){if(!this.config)return;let u=this.createArcPath(c.innerRadius,c.outerRadius,a,i),d=document.createElementNS("http://www.w3.org/2000/svg","path");d.setAttribute("d",u);let y=["rc-day-arc",`rc-ring-${g.order}`];r&&y.push("rc-day-arc--today"),s&&y.push("rc-day-arc--weekend"),o.length>0&&y.push("rc-day-arc--has-notes"),o.length>3&&y.push("rc-day-arc--many-notes"),d.setAttribute("class",y.join(" ")),d.setAttribute("data-date",`${n.year}-${String(n.month).padStart(2,"0")}-${String(n.day).padStart(2,"0")}`),d.setAttribute("data-ring",g.id),o.length>0&&(d.style.fill=h,d.style.fillOpacity="0.6"),d.addEventListener("click",async f=>{var D;f.preventDefault(),o.length>0?this.showDayContextMenu(f,n,o):await((D=this.config)==null?void 0:D.service.openDailyNote(n))}),d.addEventListener("mouseenter",f=>{this.showRingTooltip(f,n,o,g)}),d.addEventListener("mouseleave",()=>{this.hideTooltip()}),d.addEventListener("contextmenu",f=>{f.preventDefault(),this.showDayContextMenu(f,n,o)}),t.appendChild(d),o.length>0&&this.renderRingNoteIndicators(t,a,i,o,c,h)}renderRingNoteIndicators(t,n,a,i,r,s){let o=Math.min(10,(r.outerRadius-r.innerRadius)*.3),c=r.outerRadius-o,h=r.outerRadius-2,g=Math.min(i.length,3),u=(a-n)/g;for(let d=0;d<g;d++){let y=n+d*u+.001,f=y+u-.002,D=this.createArcPath(c,h,y,f),E=document.createElementNS("http://www.w3.org/2000/svg","path");E.setAttribute("d",D),E.setAttribute("class","rc-note-indicator"),E.style.fill=s,t.appendChild(E)}}showRingTooltip(t,n,a,i){var h;if(!this.tooltipEl)return;let o=`<div class="rc-tooltip-date">${`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][x(n)]}, ${Q[n.month-1]} ${n.day}, ${n.year}`}</div>`;if(o+=`<div class="rc-tooltip-ring" style="color: ${L[i.color]}">${i.name}</div>`,a.length>0){o+='<div class="rc-tooltip-notes">';for(let g of a.slice(0,5))o+=`<div class="rc-tooltip-note">${g.displayName}</div>`;a.length>5&&(o+=`<div class="rc-tooltip-more">+${a.length-5} more</div>`),o+="</div>"}this.tooltipEl.innerHTML=o,this.tooltipEl.style.display="block";let c=(h=this.containerEl_)==null?void 0:h.getBoundingClientRect();if(c){let g=t.clientX-c.left+10,u=t.clientY-c.top+10;this.tooltipEl.style.left=`${g}px`,this.tooltipEl.style.top=`${u}px`}}renderBackgroundCircle(t){let n=document.createElementNS("http://www.w3.org/2000/svg","circle");n.setAttribute("cx",String(m)),n.setAttribute("cy",String(m)),n.setAttribute("r",String(b)),n.setAttribute("class","rc-background"),t.appendChild(n)}renderCenter(t,n){let a=document.createElementNS("http://www.w3.org/2000/svg","circle");a.setAttribute("cx",String(m)),a.setAttribute("cy",String(m)),a.setAttribute("r",String(T-10)),a.setAttribute("class","rc-center"),t.appendChild(a)}renderMonthLabels(t){for(let n=0;n<12;n++){let a=this.monthToAngle(n+1)+Math.PI/12,i=m+de*Math.cos(a-Math.PI/2),r=m+de*Math.sin(a-Math.PI/2),s=document.createElementNS("http://www.w3.org/2000/svg","text");s.setAttribute("x",String(i)),s.setAttribute("y",String(r)),s.setAttribute("class","rc-month-label"),s.setAttribute("text-anchor","middle"),s.setAttribute("dominant-baseline","central"),s.textContent=Ae[n],t.appendChild(s)}}renderMonthSegment(t,n,a){if(!this.config)return;let i=C(n,a),r=this.monthToAngle(a),o=Math.PI/6/i,c=w(),h=c.year===n&&c.month===a;for(let g=1;g<=i;g++){let u=M(n,a,g),d=x(u),y=h&&c.day===g,f=d===0||d===6,D=r+(g-1)*o,E=D+o-.002,S=this.config.service.getEntriesForDate(u);this.renderDayArc(t,u,D,E,y,f,S)}this.renderMonthSeparator(t,r)}renderDayArc(t,n,a,i,r,s,o){if(!this.config)return;let c=T,h=b,g=this.createArcPath(c,h,a,i),u=document.createElementNS("http://www.w3.org/2000/svg","path");u.setAttribute("d",g);let d=["rc-day-arc"];r&&d.push("rc-day-arc--today"),s&&d.push("rc-day-arc--weekend"),o.length>0&&d.push("rc-day-arc--has-notes"),o.length>3&&d.push("rc-day-arc--many-notes"),u.setAttribute("class",d.join(" ")),u.setAttribute("data-date",`${n.year}-${String(n.month).padStart(2,"0")}-${String(n.day).padStart(2,"0")}`),u.addEventListener("click",async y=>{var f;y.preventDefault(),await((f=this.config)==null?void 0:f.service.openDailyNote(n))}),u.addEventListener("mouseenter",y=>{this.showTooltip(y,n,o)}),u.addEventListener("mouseleave",()=>{this.hideTooltip()}),u.addEventListener("contextmenu",y=>{y.preventDefault(),o.length>0&&this.showDayContextMenu(y,n,o)}),t.appendChild(u),o.length>0&&this.renderNoteIndicators(t,a,i,o)}renderNoteIndicators(t,n,a,i){let r=b-15,s=b-5,o=Math.min(i.length,3),c=(a-n)/o;for(let h=0;h<o;h++){let g=n+h*c+.001,u=g+c-.002,d=this.createArcPath(r,s,g,u),y=document.createElementNS("http://www.w3.org/2000/svg","path");y.setAttribute("d",d),y.setAttribute("class","rc-note-indicator"),t.appendChild(y)}}renderMonthSeparator(t,n){let a=m+T*Math.cos(n-Math.PI/2),i=m+T*Math.sin(n-Math.PI/2),r=m+b*Math.cos(n-Math.PI/2),s=m+b*Math.sin(n-Math.PI/2),o=document.createElementNS("http://www.w3.org/2000/svg","line");o.setAttribute("x1",String(a)),o.setAttribute("y1",String(i)),o.setAttribute("x2",String(r)),o.setAttribute("y2",String(s)),o.setAttribute("class","rc-month-separator"),t.appendChild(o)}renderTodayMarker(t,n){let a=w();if(a.year!==n)return;let i=C(n,a.month),r=this.monthToAngle(a.month),o=Math.PI/6/i,c=r+(a.day-.5)*o,h=m+(T-10)*Math.cos(c-Math.PI/2),g=m+(T-10)*Math.sin(c-Math.PI/2),u=m+(b+5)*Math.cos(c-Math.PI/2),d=m+(b+5)*Math.sin(c-Math.PI/2),y=document.createElementNS("http://www.w3.org/2000/svg","line");y.setAttribute("x1",String(h)),y.setAttribute("y1",String(g)),y.setAttribute("x2",String(u)),y.setAttribute("y2",String(d)),y.setAttribute("class","rc-today-marker"),t.appendChild(y)}createArcPath(t,n,a,i){let r=a-Math.PI/2,s=i-Math.PI/2,o=m+t*Math.cos(r),c=m+t*Math.sin(r),h=m+t*Math.cos(s),g=m+t*Math.sin(s),u=m+n*Math.cos(r),d=m+n*Math.sin(r),y=m+n*Math.cos(s),f=m+n*Math.sin(s),D=i-a>Math.PI?1:0;return`
      M ${o} ${c}
      L ${u} ${d}
      A ${n} ${n} 0 ${D} 1 ${y} ${f}
      L ${h} ${g}
      A ${t} ${t} 0 ${D} 0 ${o} ${c}
      Z
    `}monthToAngle(t){return(t-1)*Math.PI/6}showTooltip(t,n,a){var c;if(!this.tooltipEl)return;let s=`<div class="rc-tooltip-date">${`${["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"][x(n)]}, ${Q[n.month-1]} ${n.day}, ${n.year}`}</div>`;if(a.length>0){s+='<div class="rc-tooltip-notes">';for(let h of a.slice(0,5))s+=`<div class="rc-tooltip-note">${h.displayName}</div>`;a.length>5&&(s+=`<div class="rc-tooltip-more">+${a.length-5} more</div>`),s+="</div>"}this.tooltipEl.innerHTML=s,this.tooltipEl.style.display="block";let o=(c=this.containerEl_)==null?void 0:c.getBoundingClientRect();if(o){let h=t.clientX-o.left+10,g=t.clientY-o.top+10;this.tooltipEl.style.left=`${h}px`,this.tooltipEl.style.top=`${g}px`}}hideTooltip(){this.tooltipEl&&(this.tooltipEl.style.display="none")}showDayContextMenu(t,n,a){if(!this.config)return;let i=new G.Menu;i.addItem(r=>{r.setTitle(`Open ${Q[n.month-1]} ${n.day}`).setIcon("calendar").onClick(async()=>{var s;await((s=this.config)==null?void 0:s.service.openDailyNote(n))})}),i.addSeparator();for(let r of a.slice(0,10))i.addItem(s=>{s.setTitle(r.displayName).setIcon("file").onClick(()=>{var o;(o=this.config)==null||o.openFile(r.filePath)})});a.length>10&&i.addItem(r=>{r.setTitle(`+${a.length-10} more...`).setDisabled(!0)}),i.showAtMouseEvent(t)}renderOuterSegments(t,n){if(!this.config)return;let a=this.getSegmentsForCurrentView();if(a.length!==0)for(let i of a)this.renderSegmentTick(t,i,n)}getSegmentsForCurrentView(){if(!this.config)return[];let t=this.config.settings;if(t.currentView==="life")return this.lifeActsToSegments(t.lifeActs);switch(t.annualSegmentType){case"seasons":return ae;case"quarters":return re;case"semester":return ie;case"ten-days":return se();case"weeks":return oe();case"custom":return t.customSegments;case"none":default:return[]}}lifeActsToSegments(t){if(!this.config)return[];let{birthYear:n,expectedLifespan:a}=this.config.settings,i=a;return t.map(r=>{let s=Math.floor(r.startAge/i*365)+1,o=Math.floor(r.endAge/i*365);return{id:r.id,label:r.label,startDay:s,endDay:o,color:r.color}})}renderSegmentTick(t,n,a){if(!this.config)return;let i=this.config.settings.showSegmentLabels,r=this.dayOfYearToAngle(n.startDay),s=n.endDay>n.startDay?this.dayOfYearToAngle(n.endDay):this.dayOfYearToAngle(n.endDay)+2*Math.PI,o=r-Math.PI/2,c=m+ge*Math.cos(o),h=m+ge*Math.sin(o),g=m+ue*Math.cos(o),u=m+ue*Math.sin(o),d=document.createElementNS("http://www.w3.org/2000/svg","line");if(d.setAttribute("x1",String(c)),d.setAttribute("y1",String(h)),d.setAttribute("x2",String(g)),d.setAttribute("y2",String(u)),d.setAttribute("class","rc-segment-tick"),n.color&&(d.style.stroke=L[n.color]),t.appendChild(d),i){let y=(r+(n.endDay>n.startDay?s:s-2*Math.PI))/2,f=y-Math.PI/2,D=m+he*Math.cos(f),E=m+he*Math.sin(f),S=document.createElementNS("http://www.w3.org/2000/svg","text");S.setAttribute("x",String(D)),S.setAttribute("y",String(E)),S.setAttribute("class","rc-segment-label"),S.setAttribute("text-anchor","middle"),S.setAttribute("dominant-baseline","central");let A=y*180/Math.PI,N=A>90&&A<270?A+180:A;S.setAttribute("transform",`rotate(${N}, ${D}, ${E})`),n.color&&(S.style.fill=L[n.color]),S.textContent=n.label,t.appendChild(S)}}dayOfYearToAngle(t){return(t-1)/365*2*Math.PI}};var p=require("obsidian");var W=require("obsidian"),j=class extends W.AbstractInputSuggest{constructor(e,t){super(e,t),this.textInputEl=t}getSuggestions(e){let t=this.getAllFolders(),n=e.toLowerCase().trim();return n===""?t:t.filter(a=>a.path.toLowerCase().includes(n))}renderSuggestion(e,t){t.addClass("folder-suggest-item");let n=t.createSpan({cls:"folder-suggest-icon"});n.innerHTML=this.getFolderIcon(),t.createSpan({cls:"folder-suggest-text"}).setText(e.path||"/")}selectSuggestion(e,t){this.textInputEl.value=e.path,this.textInputEl.trigger("input"),this.close()}getAllFolders(){let e=[],t=a=>{e.push(a);for(let i of a.children)i instanceof W.TFolder&&t(i)},n=this.app.vault.getRoot();return t(n),e.sort((a,i)=>a.isRoot()?-1:i.isRoot()?1:a.path.localeCompare(i.path))}getFolderIcon(){return'<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>'}};var H=class extends p.PluginSettingTab{constructor(e,t){super(e,t),this.plugin=t}display(){let{containerEl:e}=this;e.empty(),this.createViewModeSection(e),this.plugin.settings.currentView==="life"&&this.createLifeViewSection(e),this.createRingConfigSection(e),this.createOuterSegmentsSection(e),this.createTemplateSection(e),this.createCenterDisplaySection(e)}createViewModeSection(e){new p.Setting(e).setName("Ansichtsmodus").setDesc("Wechseln zwischen Jahres- und Lebensansicht").addDropdown(t=>{t.addOption("annual","Jahresansicht").addOption("life","Lebensansicht").setValue(this.plugin.settings.currentView).onChange(async n=>{this.plugin.settings.currentView=n,await this.plugin.saveSettings(),this.display()})})}createLifeViewSection(e){e.createEl("h3",{text:"Lebensansicht Einstellungen"}),new p.Setting(e).setName("Geburtsjahr").setDesc("Dein Geburtsjahr").addText(t=>{t.setPlaceholder("z.B. 1990").setValue(String(this.plugin.settings.birthYear)).onChange(async n=>{let a=parseInt(n,10);!isNaN(a)&&a>1900&&a<=new Date().getFullYear()&&(this.plugin.settings.birthYear=a,await this.plugin.saveSettings())})}),new p.Setting(e).setName("Erwartete Lebensspanne").setDesc("Erwartete Lebensdauer in Jahren").addText(t=>{t.setPlaceholder("z.B. 85").setValue(String(this.plugin.settings.expectedLifespan)).onChange(async n=>{let a=parseInt(n,10);!isNaN(a)&&a>0&&a<=150&&(this.plugin.settings.expectedLifespan=a,await this.plugin.saveSettings())})})}createRingConfigSection(e){e.createEl("h3",{text:"Ringe konfigurieren"});let t=this.plugin.settings.rings;t.forEach((n,a)=>{this.createRingSettings(e,n,a)}),new p.Setting(e).addButton(n=>{n.setButtonText("Ring hinzufugen").setCta().onClick(async()=>{let a=ne(t.length);this.plugin.settings.rings=[...t,a],await this.plugin.saveSettings(),this.display()})})}createRingSettings(e,t,n){let a=e.createDiv({cls:"radial-calendar-ring-config"}),i=new p.Setting(a).setName(`Ring ${n+1}`).setClass("radial-calendar-ring-header");new p.Setting(a).setName("Name").addText(r=>{r.setPlaceholder("Ring Name").setValue(t.name).onChange(async s=>{this.updateRing(n,{name:s})})}),new p.Setting(a).setName("Ordner").setDesc("Ordnerpfad im Vault").addText(r=>{r.setPlaceholder("z.B. Projects/2024").setValue(t.folder).onChange(async s=>{this.updateRing(n,{folder:s})}),new j(this.app,r.inputEl)}),new p.Setting(a).setName("Farbe").addDropdown(r=>{Object.keys(L).forEach(s=>{r.addOption(s,this.formatColorName(s))}),r.setValue(t.color).onChange(async s=>{this.updateRing(n,{color:s})})}),new p.Setting(a).addButton(r=>{r.setButtonText("Loschen").setWarning().onClick(async()=>{this.plugin.settings.rings=this.plugin.settings.rings.filter((s,o)=>o!==n),this.plugin.settings.rings=this.plugin.settings.rings.map((s,o)=>({...s,order:o})),await this.plugin.saveSettings(),this.display()})}),a.createEl("hr")}async updateRing(e,t){let n=[...this.plugin.settings.rings];n[e]={...n[e],...t},this.plugin.settings.rings=n,await this.plugin.saveSettings()}formatColorName(e){return e.charAt(0).toUpperCase()+e.slice(1)}createOuterSegmentsSection(e){e.createEl("h3",{text:"\xC4u\xDFere Segmente"}),new p.Setting(e).setName("Segment-Typ").setDesc("Markierungen am \xE4u\xDFeren Rand des Kalenders").addDropdown(t=>{t.addOption("none","Keine").addOption("seasons","Jahreszeiten (4)").addOption("quarters","Quartale (4)").addOption("semester","Semester (2)").addOption("ten-days","10-Tages-Phasen (36)").addOption("weeks","Wochen (52)").addOption("custom","Benutzerdefiniert").setValue(this.plugin.settings.annualSegmentType).onChange(async n=>{this.plugin.settings.annualSegmentType=n,await this.plugin.saveSettings(),this.display()})}),new p.Setting(e).setName("Labels anzeigen").setDesc("Segment-Beschriftungen anzeigen").addToggle(t=>{t.setValue(this.plugin.settings.showSegmentLabels).onChange(async n=>{this.plugin.settings.showSegmentLabels=n,await this.plugin.saveSettings()})}),this.plugin.settings.annualSegmentType==="custom"&&this.createCustomSegmentsEditor(e),this.plugin.settings.currentView==="life"&&this.createLifeActsEditor(e)}createCustomSegmentsEditor(e){e.createEl("h4",{text:"Benutzerdefinierte Segmente"});let t=this.plugin.settings.customSegments;t.forEach((n,a)=>{this.createSegmentSettings(e,n,a)}),new p.Setting(e).addButton(n=>{n.setButtonText("Segment hinzuf\xFCgen").onClick(async()=>{let a={id:`seg-${Date.now()}`,label:`Segment ${t.length+1}`,startDay:1,endDay:30};this.plugin.settings.customSegments=[...t,a],await this.plugin.saveSettings(),this.display()})})}createSegmentSettings(e,t,n){let a=e.createDiv({cls:"radial-calendar-segment-config"});new p.Setting(a).setName("Label").addText(i=>{i.setValue(t.label).onChange(async r=>{this.updateSegment(n,{label:r})})}),new p.Setting(a).setName("Start-Tag").setDesc("Tag des Jahres (1-365)").addText(i=>{i.setValue(String(t.startDay)).onChange(async r=>{let s=parseInt(r,10);!isNaN(s)&&s>=1&&s<=365&&this.updateSegment(n,{startDay:s})})}),new p.Setting(a).setName("End-Tag").setDesc("Tag des Jahres (1-365)").addText(i=>{i.setValue(String(t.endDay)).onChange(async r=>{let s=parseInt(r,10);!isNaN(s)&&s>=1&&s<=365&&this.updateSegment(n,{endDay:s})})}),new p.Setting(a).addButton(i=>{i.setButtonText("L\xF6schen").setWarning().onClick(async()=>{this.plugin.settings.customSegments=this.plugin.settings.customSegments.filter((r,s)=>s!==n),await this.plugin.saveSettings(),this.display()})}),a.createEl("hr")}async updateSegment(e,t){let n=[...this.plugin.settings.customSegments];n[e]={...n[e],...t},this.plugin.settings.customSegments=n,await this.plugin.saveSettings()}createLifeActsEditor(e){e.createEl("h4",{text:"Lebensakte"});let t=this.plugin.settings.lifeActs;t.forEach((n,a)=>{this.createLifeActSettings(e,n,a)}),new p.Setting(e).addButton(n=>{n.setButtonText("Lebensakt hinzuf\xFCgen").onClick(async()=>{let a={id:`act-${Date.now()}`,label:`Akt ${t.length+1}`,startAge:0,endAge:10};this.plugin.settings.lifeActs=[...t,a],await this.plugin.saveSettings(),this.display()})})}createLifeActSettings(e,t,n){let a=e.createDiv({cls:"radial-calendar-life-act-config"});new p.Setting(a).setName("Bezeichnung").addText(i=>{i.setPlaceholder("z.B. Kindheit").setValue(t.label).onChange(async r=>{this.updateLifeAct(n,{label:r})})}),new p.Setting(a).setName("Start-Alter").addText(i=>{i.setValue(String(t.startAge)).onChange(async r=>{let s=parseInt(r,10);!isNaN(s)&&s>=0&&this.updateLifeAct(n,{startAge:s})})}),new p.Setting(a).setName("End-Alter").addText(i=>{i.setValue(String(t.endAge)).onChange(async r=>{let s=parseInt(r,10);!isNaN(s)&&s>=0&&this.updateLifeAct(n,{endAge:s})})}),new p.Setting(a).setName("Farbe").addDropdown(i=>{i.addOption("","(Standard)"),Object.keys(L).forEach(r=>{i.addOption(r,this.formatColorName(r))}),i.setValue(t.color||"").onChange(async r=>{this.updateLifeAct(n,{color:r||void 0})})}),new p.Setting(a).addButton(i=>{i.setButtonText("L\xF6schen").setWarning().onClick(async()=>{this.plugin.settings.lifeActs=this.plugin.settings.lifeActs.filter((r,s)=>s!==n),await this.plugin.saveSettings(),this.display()})}),a.createEl("hr")}async updateLifeAct(e,t){let n=[...this.plugin.settings.lifeActs];n[e]={...n[e],...t},this.plugin.settings.lifeActs=n,await this.plugin.saveSettings()}createTemplateSection(e){e.createEl("h3",{text:"Template"}),new p.Setting(e).setName("Template erstellen").setDesc("Erstellt eine Template-Datei fur Ring-Segmente im Vault").addButton(t=>{t.setButtonText("Template erstellen").onClick(async()=>{await this.createTemplateFile()})})}async createTemplateFile(){let e=this.plugin.settings.templateFolder||"Templates",t=`${e}/Radial Calendar Segment.md`;try{if(this.app.vault.getAbstractFileByPath(e)||await this.app.vault.createFolder(e),this.app.vault.getAbstractFileByPath(t)){new p.Notice(`Template existiert bereits: ${t}`);return}await this.app.vault.create(t,le),new p.Notice(`Template erstellt: ${t}`)}catch(n){console.error("Failed to create template file:",n),new p.Notice("Fehler beim Erstellen des Templates")}}createCenterDisplaySection(e){e.createEl("h3",{text:"Zentrum Anzeige"}),new p.Setting(e).setName("Anzeigemodus").setDesc("Was im Zentrum des Kalenders angezeigt wird").addDropdown(t=>{t.addOption("countdown","Countdown").addOption("stats","Statistiken").addOption("navigation","Navigation").setValue(this.plugin.settings.centerDisplay).onChange(async n=>{this.plugin.settings.centerDisplay=n,await this.plugin.saveSettings()})})}};var U=class extends J.Plugin{constructor(){super(...arguments);this.service=null;this.settings={...X}}async onload(){await this.loadSettings();let t={calendarWidth:"fit",dateProperties:["date","created","due"],endDateProperties:["endDate","end","until"],datePriority:"filename",dailyNoteFormat:this.settings.periodicNotesFormat.daily,dailyNoteFolder:"",showMultiDayBars:!0,showWeekendHighlight:!0};this.service=new _(this.app,t),await this.service.initialize(),this.registerView(I,n=>{let a=new z(n);return a.initialize({service:this.service,openFile:async i=>{let r=this.app.vault.getAbstractFileByPath(i);r instanceof J.TFile&&await this.app.workspace.getLeaf().openFile(r)},settings:this.settings,onSettingsChange:async i=>{this.settings=i,await this.saveSettings()}}),a}),this.addSettingTab(new H(this.app,this)),this.addRibbonIcon("circle","Open Radial Calendar",()=>{this.activateView()}),this.addCommand({id:"open-radial-calendar",name:"Open Radial Calendar",callback:()=>{this.activateView()}})}async onunload(){var t;(t=this.service)==null||t.destroy(),this.service=null}async loadSettings(){let t=await this.loadData();this.settings=Object.assign({},X,t)}async saveSettings(){await this.saveData(this.settings)}async activateView(){let{workspace:t}=this.app,n=null,a=t.getLeavesOfType(I);a.length>0?n=a[0]:(n=t.getLeaf("tab"),n&&await n.setViewState({type:I,active:!0})),n&&t.revealLeaf(n)}};
